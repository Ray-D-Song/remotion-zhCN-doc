---
image: /generated/articles-docs-lambda-setup.png
id: setup
title: è®¾ç½®
slug: /lambda/setup
crumb: "Lambda"
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<YouTube
  minutes={18}
  href="https://www.youtube.com/watch?v=kFVd3KnfwYY"
  thumb="https://i.ytimg.com/vi/kFVd3KnfwYY/hqdefault.jpg?sqp=-oaymwEbCKgBEF5IVfKriqkDDggBFQAAiEIYAXABwAEG&rs=AOn4CLCJOz2mu_A24NvjFQGm6GjUVssnUQ"
  title="å¦‚ä½•è®¾ç½® Remotion Lambda"
/>

## 1. å®‰è£… `@remotion/lambda`

<Installation pkg="@remotion/lambda"/>

## 2. åˆ›å»ºè§’è‰²ç­–ç•¥

- è¿›å…¥ [AWS è´¦æˆ· IAM ç­–ç•¥éƒ¨åˆ†](https://console.aws.amazon.com/iamv2/home?#/policies)
- ç‚¹å‡» "åˆ›å»ºç­–ç•¥"
- ç‚¹å‡» JSON
- åœ¨é¡¹ç›®ä¸­ï¼Œåœ¨å‘½ä»¤è¡Œä¸­é”®å…¥ `npx remotion lambda policies role` å¹¶å°†å…¶å¤åˆ¶åˆ° AWS çš„ "JSON" å­—æ®µä¸­ã€‚
- ç‚¹å‡»ä¸‹ä¸€æ­¥ã€‚åœ¨æ ‡ç­¾é¡µä¸Šï¼Œæ‚¨æ— éœ€å¡«å†™ä»»ä½•å†…å®¹ã€‚å†æ¬¡ç‚¹å‡»ä¸‹ä¸€æ­¥ã€‚
- å°†ç­–ç•¥**ç²¾ç¡®åœ°**å‘½åä¸º `remotion-lambda-policy`ã€‚å…¶ä»–å­—æ®µå¯ä»¥ä¿æŒä¸å˜ã€‚

## 3. åˆ›å»ºè§’è‰²

- è¿›å…¥ [AWS è´¦æˆ· IAM è§’è‰²éƒ¨åˆ†](https://console.aws.amazon.com/iamv2/home#/roles)
- ç‚¹å‡» "åˆ›å»ºè§’è‰²"ã€‚
- åœ¨ "ç”¨ä¾‹" ä¸‹ï¼Œé€‰æ‹© "Lambda"ã€‚ç‚¹å‡»ä¸‹ä¸€æ­¥ã€‚
- åœ¨ "æƒé™ç­–ç•¥" ä¸‹ï¼Œè¿‡æ»¤ `remotion-lambda-policy` å¹¶é€‰ä¸­å¤é€‰æ¡†ä»¥åˆ†é…æ­¤ç­–ç•¥ã€‚ç‚¹å‡»ä¸‹ä¸€æ­¥ã€‚
- åœ¨æœ€åä¸€æ­¥ä¸­ï¼Œå°†è§’è‰²å‘½åä¸º `remotion-lambda-role` **ç²¾ç¡®åœ°**ã€‚å…¶ä»–å­—æ®µå¯ä»¥ä¿æŒä¸å˜ã€‚
- ç‚¹å‡» "åˆ›å»ºè§’è‰²" ä»¥ç¡®è®¤ã€‚

## 4. åˆ›å»ºç”¨æˆ·

- è¿›å…¥ [AWS è´¦æˆ· IAM ç”¨æˆ·éƒ¨åˆ†](https://console.aws.amazon.com/iamv2/home#/users)
- ç‚¹å‡» `æ·»åŠ ç”¨æˆ·`
- è¾“å…¥ä»»ä½•ç”¨æˆ·åï¼Œä¾‹å¦‚ `remotion-user`ã€‚
- **ä¸è¦å‹¾é€‰** "å¯ç”¨æ§åˆ¶å°è®¿é—®" é€‰é¡¹ã€‚æ‚¨ä¸éœ€è¦å®ƒã€‚
- ç‚¹å‡» "ä¸‹ä¸€æ­¥"ã€‚
- å†æ¬¡ç‚¹å‡» "ä¸‹ä¸€æ­¥"ï¼Œä¸è¦æ›´æ”¹ä»»ä½•è®¾ç½®ã€‚æ‚¨ç°åœ¨åº”è¯¥åœ¨ "å®¡é˜…å¹¶åˆ›å»º" æ­¥éª¤ä¸Šã€‚
- ç‚¹å‡» "åˆ›å»ºç”¨æˆ·"ã€‚

## 5. ä¸ºç”¨æˆ·åˆ›å»ºè®¿é—®å¯†é’¥

- è¿›å…¥ [AWS è´¦æˆ· IAM ç”¨æˆ·éƒ¨åˆ†](https://console.aws.amazon.com/iamv2/home#/users)
- ç‚¹å‡»æ­¥éª¤ 4 ä¸­åˆ›å»ºçš„ç”¨æˆ·çš„åç§°ã€‚
- è½¬åˆ° "å®‰å…¨å‡­è¯" é€‰é¡¹å¡ï¼Œå¹¶æ»šåŠ¨åˆ° "è®¿é—®å¯†é’¥" éƒ¨åˆ†ã€‚
- ç‚¹å‡» "åˆ›å»ºè®¿é—®å¯†é’¥" æŒ‰é’®ã€‚
- é€‰æ‹© "åœ¨ AWS è®¡ç®—æœåŠ¡ä¸Šè¿è¡Œçš„åº”ç”¨ç¨‹åº"ã€‚
- å¿½ç•¥å¯èƒ½å‡ºç°çš„è­¦å‘Šï¼Œå¹¶é€‰ä¸­ "æˆ‘äº†è§£å»ºè®®..." å¤é€‰æ¡†ã€‚
- ç‚¹å‡» "ä¸‹ä¸€æ­¥"ã€‚
- ç‚¹å‡» "åˆ›å»ºè®¿é—®å¯†é’¥"ã€‚
- åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸­æ·»åŠ ä¸€ä¸ª `.env` æ–‡ä»¶ï¼Œå¹¶ä»¥ä»¥ä¸‹æ ¼å¼æ·»åŠ åˆšåˆšå¤åˆ¶çš„å‡­æ®ï¼š

```txt title=".env"
REMOTION_AWS_ACCESS_KEY_ID=<Access key ID>
REMOTION_AWS_SECRET_ACCESS_KEY=<Secret access key>
```

## 6. ä¸ºæ‚¨çš„ç”¨æˆ·æ·»åŠ æƒé™

- è½¬åˆ°[AWSè´¦æˆ·IAMç”¨æˆ·éƒ¨åˆ†](https://console.aws.amazon.com/iamv2/home#/users)
- é€‰æ‹©æ‚¨åˆšåˆ›å»ºçš„ç”¨æˆ·ã€‚
- åœ¨â€œæƒé™ç­–ç•¥â€é¢æ¿ä¸­çš„â€œæ·»åŠ æƒé™â€ä¸‹æ‹‰èœå•ä¸­å•å‡»â€œæ·»åŠ å†…è”ç­–ç•¥â€ã€‚
- å•å‡»â€œJSONâ€é€‰é¡¹å¡ã€‚
- åœ¨ç»ˆç«¯ä¸­è¾“å…¥ï¼š`npx remotion lambda policies user`ï¼Œå¹¶å°†æ‰“å°å‡ºçš„å†…å®¹å¤åˆ¶åˆ°AWSæ–‡æœ¬å­—æ®µä¸­ã€‚
- å•å‡»â€œReview policyâ€ã€‚
- ä¸ºç­–ç•¥å‘½åã€‚ä¾‹å¦‚`remotion-user-policy`ï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–ä»»ä½•åç§°ã€‚
- å•å‡»â€œCreate policyâ€ä»¥ç¡®è®¤ã€‚

## 7. å¯é€‰ï¼šéªŒè¯æƒé™è®¾ç½®

é€šè¿‡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ£€æŸ¥æ‰€æœ‰ç”¨æˆ·æƒé™ï¼Œå¹¶ä½¿ç”¨AWSç­–ç•¥æ¨¡æ‹Ÿå™¨éªŒè¯å®ƒä»¬ï¼š

```bash
npx remotion lambda policies validate
```

<hr/>

å¯¹äºæ¥ä¸‹æ¥çš„æ­¥éª¤ï¼Œæ‚¨å¯ä»¥åœ¨CLIä¸Šæ‰§è¡Œå®ƒä»¬ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Node.JS APIä»¥ç¼–ç¨‹æ–¹å¼æ‰§è¡Œã€‚

## 8. éƒ¨ç½²ä¸€ä¸ªå‡½æ•°

<Tabs
defaultValue="cli"
values={[
{ label: 'CLI', value: 'cli', },
{ label: 'Node.JS', value: 'node', },
]
}>
<TabItem value="cli">

é€šè¿‡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤éƒ¨ç½²ä¸€ä¸ªå¯ä»¥åœ¨æ‚¨çš„AWSè´¦æˆ·ä¸­æ¸²æŸ“è§†é¢‘çš„å‡½æ•°ï¼š

```bash
npx remotion lambda functions deploy
```

</TabItem>
<TabItem value="node">

æ‚¨å¯ä»¥ä½¿ç”¨[`deployFunction()`](/docs/lambda/deployfunction)éƒ¨ç½²ä¸€ä¸ªå¯ä»¥åœ¨æ‚¨çš„AWSè´¦æˆ·ä¸­æ¸²æŸ“è§†é¢‘çš„å‡½æ•°ã€‚

```ts twoslash
// @module: ESNext
// @target: ESNext
import { deployFunction } from "@remotion/lambda";

// ---cut---
const { functionName } = await deployFunction({
  region: "us-east-1",
  timeoutInSeconds: 120,
  memorySizeInMb: 2048,
  createCloudWatchLogGroup: true,
});
```

å‡½æ•°åç§°å°†è¢«è¿”å›ï¼Œæ‚¨å°†éœ€è¦å®ƒæ¥è¿›è¡Œæ¸²æŸ“ã€‚
</TabItem>
</Tabs>

è¯¥å‡½æ•°åŒ…å«äº†å¿…è¦çš„äºŒè¿›åˆ¶æ–‡ä»¶å’ŒJavaScriptä»£ç ï¼Œå¯ä»¥ä»[serve URL](/docs/terminology/serve-url)è·å–å¹¶è¿›è¡Œæ¸²æŸ“ã€‚å‡½æ•°ä¸Remotionç‰ˆæœ¬ç»‘å®šï¼Œå¦‚æœæ‚¨å‡çº§Remotionï¼Œæ‚¨éœ€è¦[éƒ¨ç½²ä¸€ä¸ªæ–°å‡½æ•°](/docs/lambda/upgrading)ã€‚å‡½æ•°ä¸åŒ…æ‹¬æ‚¨çš„Remotionä»£ç ï¼Œæ‚¨éœ€è¦åœ¨ä¸‹ä¸€æ­¥ä¸­éƒ¨ç½²å®ƒã€‚

## 9. éƒ¨ç½²ä¸€ä¸ªç«™ç‚¹

<Tabs
defaultValue="cli"
values={[
{ label: 'CLI', value: 'cli', },
{ label: 'Node.JS', value: 'node', },
]
}>
<TabItem value="cli">

è¿è¡Œä»¥ä¸‹å‘½ä»¤å°†æ‚¨çš„ Remotion é¡¹ç›®éƒ¨ç½²åˆ° S3 å­˜å‚¨æ¡¶ã€‚å°†é¡¹ç›®çš„ [å…¥å£ç‚¹](/docs/terminology/entry-point) ä½œä¸ºæœ€åä¸€ä¸ªå‚æ•°ä¼ é€’ã€‚

```bash
npx remotion lambda sites create src/index.ts --site-name=my-video
```

å°†æ‰“å°ä¸€ä¸ªæŒ‡å‘éƒ¨ç½²é¡¹ç›®çš„ [æœåŠ¡ URL](/docs/terminology/serve-url)ã€‚

åœ¨å°†æ¥æ›´æ–° Remotion è§†é¢‘æ—¶ï¼Œè¯·é‡æ–°éƒ¨ç½²æ‚¨çš„ç«™ç‚¹ã€‚ä¼ é€’ç›¸åŒçš„ [`--site-name`](/docs/lambda/cli/sites#--site-name) æ¥è¦†ç›–å…ˆå‰çš„éƒ¨ç½²ã€‚å¦‚æœä¸ä¼ é€’ [`--site-name`](/docs/lambda/cli/sites#--site-name)ï¼Œåˆ™æ¯æ¬¡éƒ¨ç½²éƒ½ä¼šç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ URLã€‚

</TabItem>
<TabItem value="node">

é¦–å…ˆï¼Œæ‚¨éœ€è¦åœ¨æ‚¨é¦–é€‰çš„åŒºåŸŸåˆ›å»ºä¸€ä¸ª S3 å­˜å‚¨æ¡¶ã€‚å¦‚æœå·²ç»å­˜åœ¨ä¸€ä¸ªå­˜å‚¨æ¡¶ï¼Œåˆ™å°†ä½¿ç”¨è¯¥å­˜å‚¨æ¡¶ï¼š

```ts twoslash
// @module: ESNext
// @target: ESNext
import path from "path";
import { deploySite, getOrCreateBucket } from "@remotion/lambda";

const { bucketName } = await getOrCreateBucket({
  region: "us-east-1",
});
```

æ¥ä¸‹æ¥ï¼Œå°†æ‚¨çš„ Remotion é¡¹ç›®ä¸Šä¼ åˆ° S3 å­˜å‚¨æ¡¶ã€‚æŒ‡å®šæ‚¨çš„ Remotion é¡¹ç›®çš„å…¥å£ç‚¹ï¼Œè¿™æ˜¯è°ƒç”¨ [`registerRoot()`](/docs/register-root) çš„æ–‡ä»¶ã€‚

```ts twoslash
// @module: ESNext
// @target: ESNext
import path from "path";
import { deploySite, getOrCreateBucket } from "@remotion/lambda";

const { bucketName } = await getOrCreateBucket({
  region: "us-east-1",
});
// ---cut---
const { serveUrl } = await deploySite({
  bucketName,
  entryPoint: path.resolve(process.cwd(), "src/index.ts"),
  region: "us-east-1",
  siteName: "my-video",
});
```

åœ¨å°†æ¥æ›´æ–° Remotion è§†é¢‘æ—¶ï¼Œè¯·é‡æ–°éƒ¨ç½²æ‚¨çš„ç«™ç‚¹ã€‚ä¼ é€’ç›¸åŒçš„ [`siteName`](/docs/lambda/deploysite#sitename) æ¥è¦†ç›–å…ˆå‰çš„éƒ¨ç½²ã€‚å¦‚æœä¸ä¼ é€’ [`siteName`](/docs/lambda/deploysite#sitename)ï¼Œåˆ™æ¯æ¬¡éƒ¨ç½²éƒ½ä¼šç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ URLã€‚

</TabItem>
</Tabs>

## 10. æ£€æŸ¥ AWS å¹¶å‘é™åˆ¶

æ£€æŸ¥ AWS ç»™äºˆæ‚¨è´¦æˆ·çš„å¹¶å‘é™åˆ¶ï¼š

```
npx remotion lambda quotas
```

é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªåŒºåŸŸçš„å¹¶å‘è°ƒç”¨é™åˆ¶ä¸º `1000`ã€‚ä½†æ˜¯ï¼Œæ–°è´¦æˆ·çš„é™åˆ¶å¯èƒ½ä½è‡³ [`10`](/docs/lambda/troubleshooting/rate-limit#exception-new-accounts-using-aws-lambda)ã€‚æ¯ä¸ª Remotion æ¸²æŸ“å¯èƒ½ä¼šåŒæ—¶ä½¿ç”¨å¤šè¾¾ 200 ä¸ªå‡½æ•°ï¼Œå› æ­¤å¦‚æœæ‚¨è¢«åˆ†é…çš„é™åˆ¶éå¸¸ä½ï¼Œ[æ‚¨å¯èƒ½å¸Œæœ›ç«‹å³è¯·æ±‚å¢åŠ é™åˆ¶](/docs/lambda/troubleshooting/rate-limit#request-an-increase)ã€‚

## 11. æ¸²æŸ“è§†é¢‘

<Tabs
defaultValue="cli"
values={[
{ label: 'CLI', value: 'cli', },
{ label: 'Node.JS', value: 'node', },
]
}>
<TabItem value="cli">

è·å–æ‚¨ä»ç¬¬9æ­¥æ”¶åˆ°çš„URL - æ‚¨çš„"serve URL" - å¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚è¿˜è¦ä¼ å…¥æ‚¨æƒ³è¦æ¸²æŸ“çš„[åˆæˆç‰©çš„ID](/docs/composition)ã€‚

```bash
npx remotion lambda render <serve-url> <composition-id>
```

ç›´åˆ°è§†é¢‘æ¸²æŸ“å®Œæˆï¼Œè¿›åº¦å°†è¢«æ‰“å°å‡ºæ¥ã€‚æ­å–œï¼æ‚¨ä½¿ç”¨ Remotion Lambda æ¸²æŸ“äº†æ‚¨çš„ç¬¬ä¸€ä¸ªè§†é¢‘ ğŸš€

</TabItem>
<TabItem value="node">

æ‚¨å·²ç»ä»ä¹‹å‰çš„æ­¥éª¤ä¸­è·å¾—äº†å‡½æ•°åç§°ã€‚ä½†ç”±äºæ‚¨åªéœ€è¦éƒ¨ç½²ä¸€æ¬¡å‡½æ•°ï¼Œå› æ­¤åœ¨æ¸²æŸ“è§†é¢‘ä¹‹å‰ä»¥ç¼–ç¨‹æ–¹å¼æ£€ç´¢å·²éƒ¨ç½²å‡½æ•°çš„åç§°æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œä»¥é˜²æ‚¨çš„ Node.JS ç¨‹åºé‡æ–°å¯åŠ¨ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `compatibleOnly` æ ‡å¿—è°ƒç”¨ [`getFunctions()`](/docs/lambda/getfunctions) æ¥ä»…è·å–å…·æœ‰åŒ¹é…ç‰ˆæœ¬çš„å‡½æ•°ã€‚

```ts twoslash
// @module: ESNext
// @target: ESNext
import {
  getFunctions,
  renderMediaOnLambda,
  getRenderProgress,
} from "@remotion/lambda";

const functions = await getFunctions({
  region: "us-east-1",
  compatibleOnly: true,
});

const functionName = functions[0].functionName;
```

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ [`renderMediaOnLambda()`](/docs/lambda/rendermediaonlambda) å‡½æ•°è§¦å‘æ¸²æŸ“ã€‚

```ts twoslash
// @module: ESNext
// @target: ESNext
import {
  getFunctions,
  renderMediaOnLambda,
  getRenderProgress,
} from "@remotion/lambda";

const url = "string";
const functions = await getFunctions({
  region: "us-east-1",
  compatibleOnly: true,
});

const functionName = functions[0].functionName;
// ---cut---

const { renderId, bucketName } = await renderMediaOnLambda({
  region: "us-east-1",
  functionName,
  serveUrl: url,
  composition: "HelloWorld",
  inputProps: {},
  codec: "h264",
  imageFormat: "jpeg",
  maxRetries: 1,
  framesPerLambda: 20,
  privacy: "public",
});
```

ç°åœ¨æ¸²æŸ“å°†è¿è¡Œï¼Œä¸€æ®µæ—¶é—´åè§†é¢‘å°†åœ¨æ‚¨çš„ S3 å­˜å‚¨æ¡¶ä¸­å¯ç”¨ã€‚æ‚¨éšæ—¶å¯ä»¥é€šè¿‡è°ƒç”¨ [`getRenderProgress()`](/docs/lambda/getrenderprogress) æ¥è·å–è§†é¢‘æ¸²æŸ“çš„çŠ¶æ€ã€‚

```ts twoslash
// @module: ESNext
// @target: ESNext
import {
  getFunctions,
  renderMediaOnLambda,
  getRenderProgress,
} from "@remotion/lambda";

const url = "string";
const functions = await getFunctions({
  region: "us-east-1",
  compatibleOnly: true,
});

const functionName = functions[0].functionName;

const { renderId, bucketName } = await renderMediaOnLambda({
  region: "us-east-1",
  functionName,
  serveUrl: url,
  composition: "HelloWorld",
  inputProps: {},
  codec: "h264",
  imageFormat: "jpeg",
  maxRetries: 1,
  framesPerLambda: 20,
  privacy: "public",
});
// ---cut---
while (true) {
  await new Promise((resolve) => setTimeout(resolve, 1000));
  const progress = await getRenderProgress({
    renderId,
    bucketName,
    functionName,
    region: "us-east-1",
  });
  if (progress.done) {
    console.log("Render finished!", progress.outputFile);
    process.exit(0);
  }
  if (progress.fatalErrorEncountered) {
    console.error("Error enountered", progress.errors);
    process.exit(1);
  }
}
```

æ­¤ä»£ç å°†æ¯ç§’è½®è¯¢ä»¥æ£€æŸ¥è§†é¢‘çš„è¿›åº¦ï¼Œå¹¶åœ¨æ¸²æŸ“å®Œæˆæ—¶é€€å‡ºè„šæœ¬ã€‚æ­å–œï¼[æ£€æŸ¥æ‚¨çš„ S3 å­˜å‚¨æ¡¶](https://s3.console.aws.amazon.com/s3/) - æ‚¨åˆšåˆšä½¿ç”¨ Remotion Lambda æ¸²æŸ“äº†æ‚¨çš„ç¬¬ä¸€ä¸ªè§†é¢‘ ğŸš€

</TabItem>
</Tabs>

## ä¸‹ä¸€æ­¥

- é€‰æ‹©æ‚¨æƒ³è¦åœ¨å…¶ä¸­è¿è¡Œ Remotion Lambda çš„[åŒºåŸŸ](/docs/lambda/region-selection)ã€‚
- ç†Ÿæ‚‰ CLI å’Œ Node.JS APIï¼ˆåœ¨ä¾§è¾¹æ ä¸­åˆ—å‡ºï¼‰ã€‚
- å­¦ä¹ å¦‚ä½•[å‡çº§ Remotion Lambda](/docs/lambda/upgrading)ã€‚
- åœ¨ä¸Šçº¿ä¹‹å‰ï¼Œè¯·æŸ¥çœ‹[ç”Ÿäº§æ¸…å•](/docs/lambda/checklist)ã€‚
- å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·æŸ¥çœ‹[FAQ](/docs/lambda/faq)æˆ–åœ¨æˆ‘ä»¬çš„[Discord é¢‘é“](https://remotion.dev/discord)ä¸­æé—®ã€‚
