---
image: /generated/articles-docs-lambda-insights.png
sidebar_label: 洞察
title: 启用 Lambda 洞察
crumb: "Lambda"
---

# 启用 Lambda 洞察<AvailableFrom v="4.0.61"/>

您可以为您的 Remotion Lambda 函数启用[AWS Lambda 洞察](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/Lambda-Insights.html)。

## 先决条件

<Step>1</Step> 确保您至少使用 Remotion v4.0.61。<br/>
<Step>2</Step> 如果您在 v4.0.61 之前开始使用 Remotion，请更新您的<a href="/docs/lambda/permissions#user-permissions">AWS 用户权限</a>和<a href="/docs/lambda/permissions#role-permissions">AWS 角色权限</a>，因为现在需要更多权限。

## 启用 Lambda 洞察

**通过 CLI**:

```
npx remotion lambda functions deploy --enable-lambda-insights
```

如果函数已存在，请先删除它。

**通过 Node.js APIs:**

```tsx twoslash title="deploy.ts" {8, 11-13}
// @module: ESNext
// @target: ESNext
import assert from "assert";
// ---cut---
import { deployFunction } from "@remotion/lambda";

const { alreadyExisted } = await deployFunction({
  createCloudWatchLogGroup: true,
  region: "us-east-1",
  timeoutInSeconds: 120,
  memorySizeInMb: 3009,
  enableLambdaInsights: true,
});

// Note: If the function previously already existed, Lambda insights are not applied.
// Delete the old function and deploy again.
assert(!alreadyExisted);
```

## 为 Lambda 函数添加角色

为了实际允许 Lambda 将数据发送到 CloudWatch，您需要执行以下操作：

- 转到 Lambda 仪表板并选择任何 Remotion Lambda 函数。
- 在“配置”选项卡中，向下滚动到“监控和运维工具”，在“附加监控工具”部分，单击“编辑”。
- 切换开关以启用“启用 AWS Lambda 洞察”。如果已经打开，请关闭它，保存，然后再次启用。

这将向 Lambda 函数的角色添加必要的权限。  
所有 Lambda 函数在默认设置下共享相同的角色，因此您只需要执行一次此操作。

## 查看 Lambda 洞察

在您的 CloudWatch 仪表板（[`us-east-1` 的链接](https://eu-central-1.console.aws.amazon.com/cloudwatch/home)）下的 Insights ➞ Lambda Insights ➞ 单个函数，您可以查看 Remotion Lambda 函数的指标。

[`renderMediaOnLambda()`](/docs/lambda/rendermediaonlambda) 的返回值中还包含了 Lambda 洞察的链接。

如果您通过 CLI 使用 `--log=verbose` 标志进行渲染，无论是否启用 Lambda 洞察，都会打印 Lambda 洞察的链接。

## 参见

- [调试失败的 Lambda 渲染](/docs/lambda/troubleshooting/debug) 
