---
image: /generated/articles-docs-lambda-simulatepermissions.png
id: simulatepermissions
title: simulatePermissions()
slug: /lambda/simulatepermissions
crumb: "Lambda API"
---

通过 AWS 模拟器运行测试，确保为经过身份验证的用户设置了所有必要的权限。

CLI 等效命令为 `npx remotion lambda policies validate`。

如果缺少权限，该函数不会拒绝并返回错误，而是在返回值中指示缺少的权限。

此函数仅验证**用户策略**的有效性，而不验证**角色策略**。

## 示例

```ts twoslash
// @module: esnext
// @target: es2017

import { simulatePermissions } from "@remotion/lambda";

const { results } = await simulatePermissions({
  region: "us-east-1",
});

for (const result of results) {
  console.log(result.decision); // "allowed"
  console.log(result.name); // "iam:SimulatePrincipalPolicy"
}
```

## 参数

具有以下属性的对象：

### `region`

您想要查询的[AWS 区域](/docs/lambda/region-selection)。

### `onSimulation`

_可选_

每次执行新模拟时调用的回调函数。这使您可以更快地对新的模拟结果做出反应，而不必等待函数的返回值。示例：

```ts twoslash
// @module: esnext
// @target: es2017

import { simulatePermissions } from "@remotion/lambda";

const { results } = await simulatePermissions({
  region: "us-east-1",
  onSimulation: (result) => {
    console.log(result.decision); // "allowed"
    console.log(result.name); // "iam:SimulatePrincipalPolicy"
  },
});
```

## 返回值

包含每个必要权限的模拟结果的**对象数组**。对象包含以下键：

### `decision`

`"allowed"`、`"implicitDeny"` 或 `"explicitDeny"`。

### `name`

所需权限的标识符。请参阅[权限页面](/docs/lambda/permissions)查看所需权限的列表。

## 另请参阅

- [此函数的源代码](https://github.com/remotion-dev/remotion/blob/main/packages/lambda/src/api/iam-validation/simulate.ts)
- [getUserPolicy()](/docs/lambda/getuserpolicy)
- [getRolePolicy()](/docs/lambda/getrolepolicy)
- [权限](/docs/lambda/permissions)

