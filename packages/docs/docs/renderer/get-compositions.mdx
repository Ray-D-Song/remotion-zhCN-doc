---
image: /generated/articles-docs-renderer-get-compositions.png
title: getCompositions()
id: get-compositions
crumb: '@remotion/renderer'
---

_`@remotion/renderer` 包的一部分。_

根据 [Remotion Bundle](/docs/terminology/bundle) 评估 [Remotion Root](/docs/terminology/remotion-root)，获取在 Remotion 项目中定义的合成列表。

对于每个合成，将评估它们的 [`calculateMetadata()`](/docs/composition#calculatemetadata) 函数。如果您只想评估要渲染的一个合成，请使用 [`selectComposition()`](/docs/renderer/select-composition)。

```ts
const getCompositions: (
  serveUrlOrWebpackUrl: string,
  options?: GetCompositionsConfig,
) => Promise<TComposition[]>;
```

## 参数

### `serveUrlOrWebpackUrl`

指向由 [`bundle()`](/docs/bundle) 生成的 [Remotion Bundle](/docs/terminology/bundle) 或托管捆绑的 Remotion 项目的 URL 的字符串。

### `options?`

_可选的_

包含以下一个或多个选项的对象：

#### `inputProps`

_在 &lt;5.0 中是可选的，在 5.0 中是必需的_

[要传递给视频所选合成的输入属性。](/docs/passing-props#passing-input-props-in-the-cli)。  
必须是一个 JSON 对象。  
从根组件中，可以使用 [`getInputProps()`](/docs/get-input-props) 读取属性。  
您可以使用 [`calculateMetadata()`](/docs/calculate-metadata) 转换输入属性。

#### `puppeteerInstance?`<AvailableFrom v="3.0.0" />

_可选的_

已打开的 Puppeteer [`Browser`](/docs/renderer/open-browser) 实例。使用 [`openBrowser()`](/docs/renderer/open-browser) 创建一个新实例。在多个函数调用之间重用浏览器可以加快渲染过程。您负责自行打开和关闭浏览器。如果不指定此选项，将在最后打开并关闭一个新浏览器。

#### `browserExecutable?`<AvailableFrom v="2.3.1" />

定义应使用的浏览器可执行文件的磁盘上的绝对路径的字符串。默认情况下，Remotion 将尝试自动检测并下载一个，如果没有可用的，则会下载一个。如果定义了 `puppeteerInstance`，它将优先于 `browserExecutable`。

#### `onBrowserLog?`<AvailableFrom v="3.0.0" />

_可选_

当您的项目调用 `console.log` 或控制台的另一个方法时调用。浏览器日志有三个属性：

- `text`: 被打印的消息
- `stackTrace`: 包含以下属性的对象数组：
  - `url`: 记录日志的资源的 URL。
  - `lineNumber`: 文件中调用日志的基于 0 的行号。
  - `columnNumber`: 文件中调用日志的基于 0 的列号。
- `type`: 控制台方法之一 - `log`, `debug`, `info`, `error`, `warning`, `dir`, `dirxml`, `table`, `trace`, `clear`, `startGroup`, `startGroupCollapsed`, `endGroup`, `assert`, `profile`, `profileEnd`, `count`, `timeEnd`, `verbose` 中的一个

```tsx twoslash
interface ConsoleMessageLocation {
  /**
   * URL of the resource if known or `undefined` otherwise.
   */
  url?: string;
  /**
   * 0-based line number in the resource if known or `undefined` otherwise.
   */
  lineNumber?: number;
  /**
   * 0-based column number in the resource if known or `undefined` otherwise.
   */
  columnNumber?: number;
}

type BrowserLog = {
  text: string;
  stackTrace: ConsoleMessageLocation[];
  type:
    | 'log'
    | 'debug'
    | 'info'
    | 'error'
    | 'warning'
    | 'dir'
    | 'dirxml'
    | 'table'
    | 'trace'
    | 'clear'
    | 'startGroup'
    | 'startGroupCollapsed'
    | 'endGroup'
    | 'assert'
    | 'profile'
    | 'profileEnd'
    | 'count'
    | 'timeEnd'
    | 'verbose';
};

const getCompositions = (options: {
  onBrowserLog?: (log: BrowserLog) => void;
}) => {};
// ---cut---
getCompositions({
  // ...
  onBrowserLog: (info) => {
    console.log(`${info.type}: ${info.text}`);
    console.log(
      info.stackTrace
        .map((stack) => {
          return `  ${stack.url}:${stack.lineNumber}:${stack.columnNumber}`;
        })
        .join('\n'),
    );
  },
});
```

#### `timeoutInMilliseconds?`<AvailableFrom v="2.6.3" />

描述一个帧可能需要多长时间来解析所有 [`delayRender()`](/docs/delay-render) 调用，否则[渲染超时并失败](/docs/timeout)。默认值：`30000`

#### `port?`

优先使用特定端口来提供 Remotion 项目。如果未指定，将使用随机端口。

#### `logLevel?`<AvailableFrom v="4.0.0"/>

<Options id="log" />

#### `chromiumOptions?`<AvailableFrom v="2.6.5" />

_可选_

允许您设置某些 Chromium / Google Chrome 标志。参见：[Chromium 标志](/docs/chromium-flags)。

### `offthreadVideoCacheSizeInBytes?`<AvailableFrom v="4.0.23"/>

<Options id="offthreadvideo-cache-size-in-bytes" />

### `binariesDirectory?`<AvailableFrom v="4.0.120" />

<Options id="binaries-directory" />

### `onBrowserDownload?`<AvailableFrom v="4.0.137" />

<Options id="on-browser-download" />

### ~~`ffmpegExecutable`~~

_在 v4.0 中已移除，可选_

覆盖要使用的 `ffmpeg` 可执行文件的绝对路径。

### ~~`ffprobeExecutable?`~~ <AvailableFrom v="3.0.17" />

_在 v4.0 中已移除_

覆盖要使用的 `ffprobe` 可执行文件的绝对路径。

## 返回值

返回一个解析为可用合成数组的 Promise。示例值：

```ts twoslash
[
  {
    id: 'HelloWorld',
    width: 1920,
    height: 1080,
    fps: 30,
    durationInFrames: 120,
    defaultProps: {
      title: 'Hello World',
    },
  },
  {
    id: 'Title',
    width: 1080,
    height: 1080,
    fps: 30,
    durationInFrames: 90,
    defaultProps: undefined,
  },
];
```

`defaultProps` 仅在 v2.5.7 版本之后返回。

## 参见

- [此函数的源代码](https://github.com/remotion-dev/remotion/blob/main/packages/renderer/src/get-compositions.ts)
- [服务器端渲染](/docs/ssr)
- [`bundle()`](/docs/bundle)
- [`renderMedia()`](/docs/renderer/render-media)
- [`selectComposition()`](/docs/renderer/select-composition)

