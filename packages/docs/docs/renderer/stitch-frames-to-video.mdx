---
image: /generated/articles-docs-renderer-stitch-frames-to-video.png
id: stitch-frames-to-video
title: stitchFramesToVideo()
crumb: '@remotion/renderer'
---

_属于 `@remotion/renderer` 包的一部分。_

将由 [`renderFrames()`](/docs/renderer/render-frames) 生成的一系列图像和音频信息编码为视频。

:::info
在 Remotion 3.0 中，我们添加了 [`renderMedia()`](/docs/renderer/render-media) API，它将 `renderFrames()` 和 `stitchFramesToVideo()` 结合为一个简化的步骤，并且执行渲染速度更快。如果可以的话，请优先使用 `renderMedia()`。
:::

## 参数

具有以下属性的对象：

### `fps`

指定输出视频的期望帧率的 `number`。

### `width`

指定视频的输出宽度（以像素为单位）的 `number`。

### `height`

指定视频的输出高度（以像素为单位）的 `number`。

### `assetsInfo`

关于帧和音频混音的信息。这是 [`renderFrames()`](/docs/renderer/render-frames#return-value) 的返回值的一部分。  
数据结构在 Remotion 版本之间不稳定。

### `outputLocation?`

_自 v3.0.26 起可选_

指定输出文件应写入的绝对路径。

如果未指定或设置为 `null`，则文件将以内存中的缓冲区形式返回。

### `force?`

_可选_

Remotion 是否应在 `outputLocation` 中的文件已存在时覆盖该文件。默认为 `true`。

### `pixelFormat?`

_可选_

设置像素格式。有关可用值，请参阅[此处](/docs/config#setpixelformat)。默认值为 `yuv420p`。

### `codec?`

_可选_

设置编解码器。有关可用值和选择哪个值的指导，请参阅[编码指南](/docs/encoding)。默认值为 `h264`。

### `audioCodec?`

_"pcm-16" | "aac" | "mp3" | "opus"，自 v3.3.41 起可用_

选择音频的编码方式。

- 默认值取决于所选的 `codec`。
- 如果需要无损音频，请选择 `pcm-16`。
- 并非所有视频容器都支持所有音频编解码器。
- 如果 `codec` 选项还指定了音频编解码器，则此选项优先。



请参考[编码指南](/docs/encoding/#audio-codec)查看默认值和支持的组合。

### `audioBitrate?`<AvailableFrom v="3.2.32" />

<Options id="audio-bitrate" />

### `videoBitrate?`<AvailableFrom v="3.2.32" />

<Options id="video-bitrate" />

### `bufferSize?`<AvailableFrom v="4.0.78" />

<Options id="buffer-size" />

### `maxRate?`<AvailableFrom v="4.0.78" />

<Options id="max-rate" />

### `crf?`

_可选_

输出的恒定速率因子，控制质量的参数。有关此参数的更多信息，请参见[此处](/docs/config#setcrf)。默认值取决于编解码器。

### `proResProfile?`

_可选_

设置ProRes配置文件。仅适用于使用`prores`编解码器渲染的视频。有关可能选项，请参见[编码指南](/docs/encoding/#controlling-quality-using-prores-profile)。

### `onProgress?`

_可选_

通知有关编码进度的回调函数。`frameNumber`值为`number`。

```ts twoslash
const onProgress = (frameNumber: number) => {
  console.log(`编码进度：在第 ${frameNumber} 帧`);
};
```

### `onDownload?`

_可选_

在需要下载远程资产以提取音轨时发出通知。

```ts twoslash
const onDownload = (src: string) => {
  console.log(`正在下载 ${src}...`);
};
```

### `numberOfGifLoops?`<AvailableFrom v="3.1.0" />

_可选_

<Options id="number-of-gif-loops" />

### `muted?`<AvailableFrom v="3.2.1" />

_可选_

禁用音频输出。此选项只能与视频编解码器结合使用，并且还应传递给[`renderFrames()`](/docs/renderer/render-frames)。

### `verbose?`

_可选_

一个布尔值，当设置为`true`时，将记录各种调试信息。默认为`false`。

### `cancelSignal?`<AvailableFrom v="3.0.15" />

_可选_

允许取消渲染的令牌。请参见：[`makeCancelSignal()`](/docs/renderer/make-cancel-signal)

### `enforceAudioTrack?`<AvailableFrom v="3.2.1" />

如果没有音轨，则渲染一个静音音轨。

### `binariesDirectory?`<AvailableFrom v="4.0.120" />

<Options id="binaries-directory" />

### `separateAudioTo?`<AvailableFrom v="4.0.123" />

<Options cli id="separate-audio-to" />

### `forSeamlessAacConcatenation?`<AvailableFrom v="4.0.123" />

<Options id="for-seamless-aac-concatenation" />

### `x264Preset?`

_string - optional_

<Options id="x264-preset" />

### `colorSpace?`<AvailableFrom v="4.0.28"/>

<Options id="color-space" />

### `ffmpegOverride?`<AvailableFrom v="3.2.22" />

_function - optional_

修改 Remotion 在后台使用的 FFMPEG 命令。它的工作方式类似于 reducer，这意味着您传递一个接受命令作为参数并返回新命令的函数。

```tsx twoslash
import type {FfmpegOverrideFn} from '@remotion/renderer';

const ffmpegOverride: FfmpegOverrideFn = ({type, args}) => {
  console.log(type); // "stitcher" | "pre-stitcher
  return [...args, '-vf', 'eq=brightness=0:saturation=1'];
};
```

您传递的函数必须接受一个对象作为唯一参数，该对象包含以下属性：

- `type`：为 `"stitcher"` 或 `"pre-stitcher"`。如果有足够的内存和 CPU 可用，Remotion 可能会使用并行渲染和编码，这意味着在渲染所有帧之前会生成一个预缝合器进程。您可以通过在渲染命令中添加 `--log=verbose` 来确定是否启用了并行编码。
- `args`：作为 FFMPEG 命令参数传递的字符串数组。

您的函数必须返回修改后的字符串数组。

:::warning
不建议使用此功能。在使用之前，我们想让您了解一些注意事项：

- 渲染命令可能会随着任何新的 Remotion 版本更改，即使是补丁升级也可能会破坏您对此功能的使用。
- 根据所选的编解码器、可用的 CPU 和 RAM，Remotion 可能会或可能不会使用 "并行编码"，这将导致执行多个 FFMPEG 命令。您的函数必须能够处理多次调用。
- 当使用 Remotion Lambda 时，此功能不可用。

在使用此 hack 之前，请在 [Discord](https://remotion.dev/discord) 上联系 Remotion 团队，并询问我们是否愿意以清晰的方式实现您需要的功能 - 我们经常根据用户反馈快速实现新功能。
:::

### ~~`ffmpegExecutable`~~

_在v4.0中已移除，可选_

用于自定义使用的 FFMPEG 可执行文件。默认情况下，将在您的 `PATH` 中搜索名为 `ffmpeg` 的二进制文件。

### ~~`ffprobeExecutable?`~~ <AvailableFrom v="3.0.17" />

_在v4.0中已移除，可选_

一个绝对路径，用于覆盖要使用的 `ffprobe` 可执行文件。

## 返回值

`stitchFramesToVideo()` 返回一个解析为 `nothing` 的 Promise。如果一切顺利，输出将放置在 `outputLocation` 中。

## 参见

- [此函数的源代码](https://github.com/remotion-dev/remotion/blob/main/packages/renderer/src/stitch-frames-to-video.ts)
- [bundle()](/docs/bundle)
- [服务器端渲染](/docs/ssr)
- [getCompositions()](/docs/renderer/get-compositions)
- [renderFrames()](/docs/renderer/render-frames)
- [renderMedia()](/docs/renderer/render-media)
